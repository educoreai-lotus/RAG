<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Chatbot Embed - ××™×§×¨×•×¡×¨×•×•×™×¡ ××—×¨</title>
  
  <!-- ×©×œ×‘ 2: ×˜×¢×™× ×ª ×”×¡×§×¨×™×¤×˜ ××”-BACKEND ×©×œ RAG -->
  <!-- âš ï¸ ×—×©×•×‘: BACKEND ×¨×¥ ×‘-Railway, FRONTEND ×¨×¥ ×‘-Vercel -->
  <!-- ×”×§×‘×¦×™× embed ××•×’×©×™× ××”-BACKEND (Railway), ×œ× ××”-FRONTEND (Vercel)! -->
  <script src="https://rag-production-3a4c.up.railway.app/embed/bot.js"></script>
  
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }
    .info-box {
      background: #e3f2fd;
      border: 2px solid #2196f3;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }
    .success {
      background: #e8f5e9;
      border-color: #4caf50;
    }
    .warning {
      background: #fff3e0;
      border-color: #ff9800;
    }
  </style>
</head>
<body>
  <h1>ğŸ§ª ×‘×“×™×§×ª ×”×˜××¢×ª Chatbot ×‘××™×§×¨×•×¡×¨×•×•×™×¡</h1>
  
  <div class="info-box warning">
    <h3>âš ï¸ ×œ×¤× ×™ ×©×ª××©×™×š:</h3>
    <ol>
      <li><strong>×•×“× ×©×”-backend ×©×œ RAG ×¨×¥ ×‘-Railway</strong> - ×‘×“×•×§: <code>curl https://rag-production-3a4c.up.railway.app/health</code></li>
      <li><strong>×–×›×•×¨:</strong> BACKEND ×¨×¥ ×‘-Railway, FRONTEND ×¨×¥ ×‘-Vercel (××‘×œ ×œ× ××©×ª××©×™× ×‘×• ×œ×”×˜××¢×”)</li>
      <li><strong>×•×“× ×©-Support Mode ××•×¤×¢×œ</strong> - ×‘-.env ×©×œ ×”-backend: <code>SUPPORT_MODE_ENABLED=true</code></li>
      <li><strong>×”×’×“×¨ Origins ××•×¨×©×™×</strong> - ×‘-.env: <code>SUPPORT_ALLOWED_ORIGINS=https://your-microservice.com</code></li>
      <li><strong>×‘× ×” ××ª ×”-frontend</strong> - ×”×¨×¥: <code>cd FRONTEND && npm run build</code></li>
    </ol>
  </div>
  
  <div class="info-box">
    <h3>ğŸ“‹ ××” ×§×•×¨×” ×›××Ÿ:</h3>
    <ol>
      <li>×”×¡×§×¨×™×¤×˜ × ×˜×¢×Ÿ ××”-backend ×©×œ RAG: <code>/embed/bot.js</code></li>
      <li>×”-script ×˜×•×¢×Ÿ ××•×˜×•××˜×™×ª ××ª <code>bot-bundle.js</code> (React widget)</li>
      <li>×”-widget ××•×¤×™×¢ ×‘×“×£ ×•××ª×—×‘×¨ ×œ-backend ×©×œ RAG</li>
      <li><strong>SUPPORT MODE</strong> (Assessment/DevLab): ×”×•×“×¢×•×ª × ×©×œ×—×•×ª ×œ-<code>/api/assessment/support</code> ××• <code>/api/devlab/support</code></li>
      <li><strong>CHAT MODE</strong> (×›×œ ×”×©××¨): ×”×•×“×¢×•×ª × ×©×œ×—×•×ª ×œ-<code>/api/v1/query</code> (RAG API)</li>
    </ol>
  </div>
  
  <h2>×ª×•×›×Ÿ ×”××™×§×¨×•×¡×¨×•×•×™×¡ ×©×œ×š ×›××Ÿ...</h2>
  <p>×–×” ×™×›×•×œ ×œ×”×™×•×ª ×›×œ ×ª×•×›×Ÿ ×©×œ ×”××™×§×¨×•×¡×¨×•×•×™×¡ ×©×œ×š (Assessment, DevLab, ×•×›×•')</p>
  
  <!-- ×©×œ×‘ 1: ×”-container ×©×œ ×”-bot -->
  <div id="edu-bot-container"></div>
  
  <!-- ×©×œ×‘ 3: ××ª×—×•×œ ×”-bot ××—×¨×™ ×©×”××©×ª××© ×”×ª×—×‘×¨ -->
  <script>
    // ×¤×•× ×§×¦×™×” ×œ×“×•×’××” - ×”×—×œ×£ ×‘×¤×•× ×§×¦×™×™×ª ×”××™××•×ª ×©×œ×š
    function getCurrentUser() {
      // ×‘×“×•×’××” ×–×•, × ×©×ª××© ×‘×¢×¨×›×™× ×¡×˜×˜×™×™×
      // ×‘×¤×•×¢×œ, ×ª×§×‘×œ ××ª ×–×” ××”××™××•×ª ×©×œ×š
      return {
        id: "test-user-123",
        token: "test-token-here", // JWT token ×××™×ª×™
        tenantId: "default"
      };
    }
    
    function initChatbot() {
      const user = getCurrentUser();
      
      if (user && user.id && user.token) {
        // ×‘×“×•×§ ×× ×”×¡×§×¨×™×¤×˜ × ×˜×¢×Ÿ
        if (window.initializeEducoreBot) {
          console.log('âœ… Initializing chatbot...');
          window.initializeEducoreBot({
            microservice: "ASSESSMENT",  // SUPPORT MODE: "ASSESSMENT" ××• "DEVLAB"
            // CHAT MODE: "DIRECTORY", "COURSE_BUILDER", "CONTENT_STUDIO", "SKILLS_ENGINE", 
            //            "LEARNER_AI", "LEARNING_ANALYTICS", "HR_MANAGEMENT_REPORTING" ××• ×›×œ ×©× ××—×¨
            userId: user.id,
            token: user.token,
            tenantId: user.tenantId || "default"
          });
          console.log('âœ… Chatbot initialized!');
        } else {
          // ×”×¡×§×¨×™×¤×˜ ×¢×“×™×™×Ÿ ×œ× × ×˜×¢×Ÿ, × ×¡×” ×©×•×‘
          console.log('â³ Waiting for script to load...');
          setTimeout(initChatbot, 100);
        }
      } else {
        console.warn('âš ï¸ User not authenticated. Chatbot will not initialize.');
      }
    }
    
    // ××ª×—×œ ×›×©×”×“×£ × ×˜×¢×Ÿ
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initChatbot);
    } else {
      initChatbot();
    }
    
    // ×‘×“×™×§×•×ª ×‘×§×•× ×¡×•×œ
    setTimeout(() => {
      console.log('ğŸ” Debug Info:');
      console.log('  - Script loaded:', window.EDUCORE_BOT_LOADED);
      console.log('  - Init function:', typeof window.initializeEducoreBot);
      console.log('  - Container exists:', !!document.querySelector('#edu-bot-container'));
      console.log('  - Bundle loaded:', window.EDUCORE_BOT_BUNDLE_LOADED);
    }, 2000);
  </script>
  
  <div class="info-box success">
    <h3>âœ… ×× ×”×›×œ ×¢×•×‘×“:</h3>
    <ul>
      <li>×ª×¨××” ×›×¤×ª×•×¨ chatbot ×‘×¤×™× ×” ×”×™×× ×™×ª ×”×ª×—×ª×•× ×”</li>
      <li>×œ×—×™×¦×” ×¢×œ×™×• ×ª×¤×ª×— ××ª ×—×œ×•×Ÿ ×”×¦'××˜</li>
      <li>×ª×•×›×œ ×œ×©×œ×•×— ×”×•×“×¢×•×ª ×•×œ×§×‘×œ ×ª×©×•×‘×•×ª</li>
      <li><strong>SUPPORT MODE</strong> (Assessment/DevLab): ×ª×©×•×‘×•×ª ××”××™×§×¨×•×¡×¨×•×•×™×¡ ×™×©×™×¨×•×ª</li>
      <li><strong>CHAT MODE</strong> (×›×œ ×”×©××¨): ×ª×©×•×‘×•×ª ×-RAG (OpenAI + Knowledge Base)</li>
    </ul>
  </div>
  
  <div class="info-box warning">
    <h3>ğŸ› ×× ×–×” ×œ× ×¢×•×‘×“:</h3>
    <ul>
      <li>×¤×ª×— ××ª ×”-Console ×‘×“×¤×“×¤×Ÿ (F12) ×•×‘×“×•×§ ×©×’×™××•×ª</li>
      <li>×‘×“×•×§ ×‘-Network tab ×× <code>bot.js</code> ×•-<code>bot-bundle.js</code> × ×˜×¢× ×• (status 200)</li>
      <li>×•×“× ×©×”-backend ×¨×¥ ×•××©×¨×ª ××ª ×”×§×‘×¦×™×</li>
      <li>×‘×“×•×§ ×©×’×™××•×ª CORS - ××•×œ×™ ×¦×¨×™×š ×œ×”×•×¡×™×£ ××ª ×”-origin ×œ-<code>SUPPORT_ALLOWED_ORIGINS</code></li>
    </ul>
  </div>
</body>
</html>

